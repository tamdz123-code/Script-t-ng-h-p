local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ScriptMenuGui"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Size = UDim2.new(0, 60, 0, 60)
toggleButton.Position = UDim2.new(0, 10, 0.5, -30)
toggleButton.BackgroundColor3 = Color3.fromRGB(0, 162, 255)
toggleButton.Text = "☰"
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.TextScaled = true
toggleButton.Font = Enum.Font.SourceSansBold
toggleButton.ZIndex = 100
toggleButton.Parent = screenGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 30)
toggleCorner.Parent = toggleButton

local dragging = false
local dragStart = nil
local startPos = nil
local clickTimer = 0

local menuOpen = false
local menuFrame = Instance.new("Frame")
menuFrame.Name = "MenuFrame"
menuFrame.Size = UDim2.new(0.8, 0, 0.7, 0)
menuFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
menuFrame.AnchorPoint = Vector2.new(0.5, 0.5)
menuFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
menuFrame.BackgroundTransparency = 0.1
menuFrame.BorderSizePixel = 0
menuFrame.Visible = false
menuFrame.ZIndex = 100
menuFrame.Parent = screenGui

local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0, 15)
frameCorner.Parent = menuFrame

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0.1, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Danh Sách Script"
titleLabel.TextColor3 = Color3.new(1, 1, 1)
titleLabel.TextScaled = true
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.ZIndex = 101
titleLabel.Parent = menuFrame

local searchBox = Instance.new("TextBox")
searchBox.Size = UDim2.new(0.9, 0, 0.05, 0)
searchBox.Position = UDim2.new(0.05, 0, 0.12, 0)
searchBox.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
searchBox.Text = ""
searchBox.PlaceholderText = "Nhập tên trò chơi..."
searchBox.TextColor3 = Color3.new(1, 1, 1)
searchBox.TextScaled = true
searchBox.Font = Enum.Font.SourceSans
searchBox.ZIndex = 101
searchBox.Parent = menuFrame

local searchCorner = Instance.new("UICorner")
searchCorner.CornerRadius = UDim.new(0, 8)
searchCorner.Parent = searchBox

local scrollingFrame = Instance.new("ScrollingFrame")
scrollingFrame.Size = UDim2.new(0.9, 0, 0.78, 0)
scrollingFrame.Position = UDim2.new(0.05, 0, 0.18, 0)
scrollingFrame.BackgroundTransparency = 1
scrollingFrame.ScrollBarThickness = 8
scrollingFrame.ZIndex = 101
scrollingFrame.Parent = menuFrame

local listLayout = Instance.new("UIListLayout")
listLayout.Padding = UDim.new(0, 8)
listLayout.Parent = scrollingFrame

local scriptList = {
    {
        Name = "script fake thông báo blox fruit",
        Description = "fake thông báo nhặt trái blox fruit",
        Game = "Blox Fruits",
        ScriptId = "loadstring(game:HttpGet('https://raw.githubusercontent.com/tamdz123-code/idk/refs/heads/main/Fake%20tb%20blox%20fruit'))()"
    },
    {
        Name = "Auto Farm",
        Description = "Tự động farm tài nguyên",
        Game = "Brookhaven RP",
        ScriptId = "print('Auto Farm activated for Brookhaven RP!')"
    },
    {
        Name = "Speed Boost",
        Description = "Tăng tốc độ di chuyển",
        Game = "Jailbreak",
        ScriptId = "game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 50"
    },
    {
        Name = "Infinite Ammo",
        Description = "Đạn không giới hạn",
        Game = "Arsenal",
        ScriptId = "print('Infinite Ammo for Arsenal!')"
    },
    {
        Name = "Pet Unlock",
        Description = "Mở khóa pet nhanh",
        Game = "Pet Simulator X",
        ScriptId = "print('Pet Unlock for Pet Simulator X!')"
    },
    {
        Name = "Adopt All",
        Description = "Áp dụng tất cả pet",
        Game = "Adopt Me",
        ScriptId = "print('Adopt All for Adopt Me!')"
    },
    {
        Name = "No Clip",
        Description = "Đi xuyên tường",
        Game = "Doors",
        ScriptId = "print('No Clip for Doors!')"
    },
    {
        Name = "Aimbot",
        Description = "Tự động ngắm bắn",
        Game = "Phantom Forces",
        ScriptId = "print('Aimbot for Phantom Forces!')"
    },
}

local function updateScriptList()
    for _, child in ipairs(scrollingFrame:GetChildren()) do
        if child:IsA("GuiObject") then
            child:Destroy()
        end
    end
    
    local searchText = searchBox.Text:lower()
    local filteredScripts = {}
    
    if searchText == "" then
        filteredScripts = scriptList
    else
        for _, scriptData in ipairs(scriptList) do
            if string.find(scriptData.Game:lower(), searchText, 1, true) then
                table.insert(filteredScripts, scriptData)
            end
        end
    end
    
    if #filteredScripts == 0 then
        local noResultLabel = Instance.new("TextLabel")
        noResultLabel.Size = UDim2.new(1, 0, 0, 50)
        noResultLabel.BackgroundTransparency = 1
        noResultLabel.Text = "Không tìm thấy script cho trò chơi này"
        noResultLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
        noResultLabel.TextScaled = true
        noResultLabel.Font = Enum.Font.SourceSans
        noResultLabel.ZIndex = 102
        noResultLabel.Parent = scrollingFrame
    else
        for _, scriptData in ipairs(filteredScripts) do
            local gameLabel = Instance.new("TextLabel")
            gameLabel.Size = UDim2.new(1, -10, 0, 20)
            gameLabel.BackgroundTransparency = 1
            gameLabel.Text = "Game: " .. scriptData.Game
            gameLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
            gameLabel.TextScaled = true
            gameLabel.Font = Enum.Font.SourceSansItalic
            gameLabel.ZIndex = 102
            gameLabel.Parent = scrollingFrame

            local button = Instance.new("TextButton")
            button.Size = UDim2.new(1, -10, 0, 60)
            button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            button.Text = scriptData.Name .. ": " .. scriptData.Description
            button.TextColor3 = Color3.new(1, 1, 1)
            button.TextScaled = true
            button.ZIndex = 102
            button.Parent = scrollingFrame
            
            local corner = Instance.new("UICorner")
            corner.CornerRadius = UDim.new(0, 8)
            corner.Parent = button
            
            button.Activated:Connect(function()
                print("Chạy script: " .. scriptData.Name .. " cho game: " .. scriptData.Game)
                local success, result = pcall(function()
                    return loadstring(scriptData.ScriptId)()
                end)
                if not success then
                    warn("Lỗi khi chạy script " .. scriptData.Name .. ": " .. tostring(result))
                end
            end)
        end
    end
    
    scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, math.max(50, #filteredScripts * 88))
end

searchBox:GetPropertyChangedSignal("Text"):Connect(updateScriptList)
updateScriptList()

local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0.08, 0, 0.08, 0)
closeButton.Position = UDim2.new(0.92, 0, 0, 5)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
closeButton.Text = "✕"
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.TextScaled = true
closeButton.ZIndex = 101
closeButton.Parent = menuFrame

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 20)
closeCorner.Parent = closeButton

local tweenInfo = TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out)

local function toggleMenu()
    menuOpen = not menuOpen
    print("Toggle menu: " .. tostring(menuOpen))
    if menuOpen then
        menuFrame.Visible = true
        toggleButton.Text = "✕"
        toggleButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
        menuFrame.Position = UDim2.new(1.2, 0, 0.5, 0)
        local openTween = TweenService:Create(menuFrame, tweenInfo, {Position = UDim2.new(0.5, 0, 0.5, 0)})
        openTween:Play()
    else
        toggleButton.Text = "☰"
        toggleButton.BackgroundColor3 = Color3.fromRGB(0, 162, 255)
        local closeTween = TweenService:Create(menuFrame, tweenInfo, {Position = UDim2.new(-0.7, 0, 0.5, 0)})
        closeTween:Play()
        closeTween.Completed:Connect(function()
            menuFrame.Visible = false
            menuFrame.Position = UDim2.new(1.2, 0, 0.5, 0)
        end)
    end
end

local function onInputBegan(input, gameProcessed)
    if gameProcessed or (input.UserInputType ~= Enum.UserInputType.MouseButton1 and input.UserInputType ~= Enum.UserInputType.Touch) then
        return
    end
    dragging = true
    dragStart = Vector2.new(input.Position.X, input.Position.Y)
    startPos = toggleButton.Position
    clickTimer = tick()
end

local function onInputChanged(input, gameProcessed)
    if gameProcessed or (input.UserInputType ~= Enum.UserInputType.MouseMovement and input.UserInputType ~= Enum.UserInputType.Touch) then
        return
    end
    if dragging then
        local delta = Vector2.new(input.Position.X, input.Position.Y) - dragStart
        toggleButton.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end

local function onInputEnded(input, gameProcessed)
    if gameProcessed or (input.UserInputType ~= Enum.UserInputType.MouseButton1 and input.UserInputType ~= Enum.UserInputType.Touch) then
        return
    end
    dragging = false
    if tick() - clickTimer <= 0.2 then
        print("Click detected, toggling menu")
        toggleMenu()
    end
end

toggleButton.InputBegan:Connect(onInputBegan)
toggleButton.InputChanged:Connect(onInputChanged)
toggleButton.InputEnded:Connect(onInputEnded)

closeButton.Activated:Connect(toggleMenu)

print("Script loaded. Bấm nút ☰ để mở/đóng menu hoặc kéo thả nút (kiểm tra console).")